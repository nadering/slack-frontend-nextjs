"use client";

import type { Metadata } from "next";
import { Inter } from "next/font/google";
import { RecoilRoot } from "recoil";
import { QueryClient, QueryClientProvider } from "react-query";
import { Amplify, I18n } from "aws-amplify";
import { Authenticator, translations } from "@aws-amplify/ui-react";
import { AwsConfig, AwsKoVocabularies } from "./_auth";
import "adorable-css";
import "@aws-amplify/ui-react/styles.css";
import "./globals.scss";
import "./fonts.scss";

Amplify.configure({ ...AwsConfig, ssr: true });
I18n.putVocabularies(translations);
I18n.setLanguage("ko");
I18n.putVocabulariesForLanguage("ko", AwsKoVocabularies);

const inter = Inter({ subsets: ["latin"] });
const queryClient = new QueryClient();

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
  icons: {
    icon: "/images/slack_icon.svg",
  },
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <RecoilRoot>
      <QueryClientProvider client={queryClient}>
        <Authenticator.Provider>
          <html lang="ko">
            <head>
              <title>클론 코딩 | Slack</title>
              <meta
                name="description"
                content="Slack Clone-Coding with React / Spring"
              />
              <link rel="icon" href="/images/slack-icon.svg" />
            </head>
            <body className={inter.className}>
              <div className="app" data-theme="light">
                <Authenticator
                  initialState="signIn"
                  signUpAttributes={["nickname", "email"]}
                  socialProviders={["google"]}
                  variation="modal"
                  formFields={{
                    signUp: {
                      username: {
                        order: 1,
                      },
                      nickname: {
                        order: 2,
                      },
                      email: {
                        order: 3,
                      },
                      password: {
                        order: 4,
                      },
                      confirm_password: {
                        order: 5,
                      },
                    },
                  }}
                >
                  {children}
                </Authenticator>
              </div>
            </body>
          </html>
        </Authenticator.Provider>
      </QueryClientProvider>
    </RecoilRoot>
  );
}
